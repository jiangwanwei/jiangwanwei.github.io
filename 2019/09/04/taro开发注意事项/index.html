<!-- build time:Wed Sep 04 2019 21:30:15 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="https://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="Taro,"><meta name="description" content="近两个项目的开发采用的是 Taro 多终端开发框架，一个为优电车管段微信小程序、另一个是奇遇的Wap版本，这里列一下我在开发中遇到的注意事项。框架简介用官方的一句简单的概括就是 “多端统一开发解决方案”（京东 凹凸实验室 出品，star 20131），重点是一套 遵循 React 语法规范 的 多端开发 解决方案。这也就能帮我们前端er们解决这个多终端的问题，帮我们节省大量开发时间，从此以后 wa"><meta name="keywords" content="Taro"><meta property="og:type" content="article"><meta property="og:title" content="taro开发注意事项"><meta property="og:url" content="http://yoursite.com/2019/09/04/taro开发注意事项/index.html"><meta property="og:site_name" content="Vay&#39;s Blog"><meta property="og:description" content="近两个项目的开发采用的是 Taro 多终端开发框架，一个为优电车管段微信小程序、另一个是奇遇的Wap版本，这里列一下我在开发中遇到的注意事项。框架简介用官方的一句简单的概括就是 “多端统一开发解决方案”（京东 凹凸实验室 出品，star 20131），重点是一套 遵循 React 语法规范 的 多端开发 解决方案。这也就能帮我们前端er们解决这个多终端的问题，帮我们节省大量开发时间，从此以后 wa"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2019-09-04T13:28:35.025Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="taro开发注意事项"><meta name="twitter:description" content="近两个项目的开发采用的是 Taro 多终端开发框架，一个为优电车管段微信小程序、另一个是奇遇的Wap版本，这里列一下我在开发中遇到的注意事项。框架简介用官方的一句简单的概括就是 “多端统一开发解决方案”（京东 凹凸实验室 出品，star 20131），重点是一套 遵循 React 语法规范 的 多端开发 解决方案。这也就能帮我们前端er们解决这个多终端的问题，帮我们节省大量开发时间，从此以后 wa"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/2019/09/04/taro开发注意事项/"><title>taro开发注意事项 | Vay's Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Vay's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">withYou</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-list"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/04/taro开发注意事项/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="jiangwanwei"><meta itemprop="description" content=""><meta itemprop="image" content="/images/raul.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Vay's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">taro开发注意事项</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-04T21:27:00+08:00">2019-09-04</time></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>近两个项目的开发采用的是 <code>Taro</code> 多终端开发框架，一个为优电车管段微信小程序、另一个是奇遇的Wap版本，这里列一下我在开发中遇到的注意事项。</p></blockquote><h2 id="框架简介"><a href="#框架简介" class="headerlink" title="框架简介"></a>框架简介</h2><p>用官方的一句简单的概括就是 “多端统一开发解决方案”（京东 <em>凹凸实验室</em> 出品，star 20131），重点是一套 <strong><em>遵循 <code>React</code> 语法规范</em></strong> 的 多端开发 解决方案。这也就能帮我们前端er们解决这个多终端的问题，帮我们节省大量开发时间，从此以后 wap、微信小程序、支付宝小程序、百度小程序、快应用、字节跳动小程序、qq轻应用、ReactNative 一套代码轻松搞定，当然由于各个终端格子的表现形式不一，我们不得不针对性的做一些代码兼容（官方也提供兼容处理形式：以文件后缀来区分针对不同的端打包运行 eg: vehicle.h5.js 只会针对h5运行…，以及环境变量的提供 <code>process.env.TARO_ENV = weapp / swan / alipay / h5 / rn / tt</code>，具体开发场景自己针对性的选择），但很明显也比同样的功能正对不同的平台多次开发便利很多。</p><h2 id="语法风格"><a href="#语法风格" class="headerlink" title="语法风格"></a>语法风格</h2><p>Taro 的语法规则基于 React 规范，它采用与 React 一致的组件化思想，组件生命周期与 React 保持一致，同时在书写体验上也尽量与 React 类似，支持使用 JSX 语法，让代码具有更丰富的表现力。但是有一点就是react更新后的一段时间 Taro才会更新相同的语法功能，例如hooks在我们现在使用的版本未支持，但是其实react很早就更新了这块内容，而taro在1.30 bate版本才支持。</p><blockquote><p>现在多端开发有基于react语法的taro、也有基于vue的uniapp，滴滴的chameleon等，说明这一块值得我们前端掌握。因为小微信小程序、支付宝小程序等api以及写法都大同小异的比较难用。</p></blockquote><h2 id="不足"><a href="#不足" class="headerlink" title="不足"></a>不足</h2><p>2018年4月份第一个正式版推出第一个版本，到现在的时间也不过才一年多：</p><p>1、<strong><em>存在bug</em></strong> 比如选择上传方法 <code>Taro.chooseImage</code> 在小程序表现正常但是在H5中选择返回的File对象无效的问题，在1.3的版本里面已经修复(多上issues找找，或许你遇到的问题能找到决绝方案)。</p><p>2、<strong><em>生态圈不成熟</em></strong> 虽然能像写 <code>react</code> 一样开发，但是要在taro中使用必须要针对taro开发，也就是说基于react的小工具、插件等不能运行在taro，我们不得不自己去做一些轮子。（目前Taro团队也在征集优秀的库 <a href="https://taro-ext.jd.com/?page=1" target="_blank" rel="external">官方物料市场</a>, 看样子征集不理想还比较少，质量也貌似不太好）</p><p>3、<strong><em>React自身部分语法不能使用</em></strong> 因为是多终端，所以像wap能用的BOM方法、DOM方法以及react能用的方法等在其他端就不能生效等。(cache、localstorage、React.createClass等)</p><p>4、<strong><em>配置存在差异</em></strong> react中我们大多完全基于webpack打包，而在taro中webpack配置只是配置中的一部分，所以你熟悉之前写webpack配置在taro中会存在写法上的差异，但是大同小异。</p><p>5、<strong><em>代码写法差异</em></strong> 比如react引用中请求可以用其他任意工具比如axios、fetch等，但是在taro中只能用 <code>Taro.request</code> ，其他还有分享等。</p><p>…</p><p>尽管才出来一年多，但是还是有很多不少的公司已投入生产环境，其中不乏大公司的部分业务在使用（京东、拼多多、猫眼等）</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用 yarn 安装 CLI</span></div><div class="line">$ npm install -g @tarojs/cli</div><div class="line"></div><div class="line"><span class="comment"># 创建项目</span></div><div class="line">$ taro init myApp</div></pre></td></tr></table></figure><p><em>cli 很重要，必须安装并且和开发依赖的taro包保持一致。比如我们开发中依赖的 taro版本为1.2.23，那么cli的版本对应的要一致，因为我们在开发中，以及生产打包都会用到cli，如果我们依赖的版本高，而我们本地cli版本低，那么就会存在部分语法在cli中不识别从而导致打包或运行失败。</em></p><p>安装成功后可以看到目录结构跟我们 用 <code>cerate-react-app</code> 创建的目录差不多, 数据方面我们选择的模板是redux，异步数据saga的安装方式没有变化。</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>项目配置：各个平台有自己的配置文件。(微信小程序，project.config.json、百度智能小程序，project.swan.json、快应用，manifest.json) 其他平台暂无；</p><p>打包配置：<code>/config/dev.js | /config/prod.js</code> 中对应的webpack配置方式（小程序和h5有单独自己的配置.h5 .weapp），例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  env: &#123;</div><div class="line">    NODE_ENV: <span class="string">'"development"'</span></div><div class="line">  &#125;,</div><div class="line">  defineConstants: &#123;</div><div class="line">  &#125;,</div><div class="line">  weapp: &#123;&#125;,</div><div class="line">  h5: &#123;</div><div class="line">    devServer: &#123;</div><div class="line">      port: <span class="number">10087</span>,</div><div class="line">      proxy: &#123;</div><div class="line">        <span class="string">'/api/'</span>: &#123;</div><div class="line">          target: <span class="string">'https://motoapi.sodacar.com'</span>,</div><div class="line">          pathRewrite: &#123;</div><div class="line">            <span class="string">'^/api/'</span>: <span class="string">'/'</span></div><div class="line">          &#125;,</div><div class="line">          changeOrigin: <span class="literal">true</span></div><div class="line">        &#125;,</div><div class="line">        <span class="string">'/auth/'</span>: &#123;</div><div class="line">          target: <span class="string">'https://motoauthapi.sodacar.com'</span>,</div><div class="line">          pathRewrite: &#123;</div><div class="line">            <span class="string">'^/auth/'</span>: <span class="string">'/'</span></div><div class="line">          &#125;,</div><div class="line">          changeOrigin: <span class="literal">true</span></div><div class="line">        &#125;,</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// 合并reducers 和sagas</span></div><div class="line">    webpackChain (chain, webpack) &#123;</div><div class="line">      chain.merge(&#123;</div><div class="line">        plugin: &#123;</div><div class="line">          install: &#123;</div><div class="line">            plugin: <span class="keyword">new</span> reduxSagaHelperPlugin(),</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>我们更多的关注的是 <code>webpackChain、devServer、router、cssModule、alias、plugins</code> 的配置。</p><p>详细参考 <a href="https://taro-docs.jd.com/taro/docs/config-detail.html" target="_blank" rel="external">编译配置详情</a></p><p><em>需要提一下的就是全局plugin，目前有四个固定的配置babel、uglify、csso、sass，配置api和官方一模一样。例如我们需要配置sass相关:</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">plugins: &#123;</div><div class="line">  sass: &#123;</div><div class="line">    resource: path.resolve(__dirname, <span class="string">'..'</span>, <span class="string">'src/styles/variable.scss'</span>),</div><div class="line">    <span class="comment">// OR </span></div><div class="line">    <span class="comment">// resource:  ['path/to/global.variable.scss', 'path/to/global.mixin.scss']</span></div><div class="line">    projectDirectory: path.resolve(__dirname, <span class="string">'..'</span>),</div><div class="line">    data: <span class="string">'$nav-height: 48px;'</span>,</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// resource: 如果要引入多个文件，支持数组形式传入</span></div><div class="line"><span class="comment">// projectDirectory: 项目根目录的绝对地址(若为小程序云开发模板，则应该是client目录)</span></div><div class="line"><span class="comment">// data: 全局 scss 变量，若 data 与 resource 中设置了同样的变量，则 data 的优先级高于 resource</span></div><div class="line">...</div></pre></td></tr></table></figure><h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>路由方面来说跟 <code>react</code> 比起来，那就差的太多了，最多只能用过高阶组件来做到一些公用的逻辑操作（例如身份验证等），应该是考虑到小程序是没有组件继承的说法（当然H5相对支持要好些，比如能支持组件反向继承时对render进行劫持来做一些判断性的组件显示等，看到taro官方说后续会进行实现）。路由配置都是在 <code>src/app.js</code> 中, 如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line">  config = &#123;</div><div class="line">    pages: [</div><div class="line">      <span class="string">'pages/index/index'</span>,</div><div class="line">      <span class="string">'pages/login/index'</span>,</div><div class="line">      <span class="string">'pages/notFound/index'</span>,</div><div class="line">    ],</div><div class="line">    ...</div></pre></td></tr></table></figure><p>跳转api为 <code>Taro.navigateTo</code>, 例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 传入参数 id=2&amp;type=test</span></div><div class="line">Taro.navigateTo(&#123;</div><div class="line">  url: <span class="string">'/pages/page/path/name?id=2&amp;type=test'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 获取方式</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">Taro</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  componentWillMount () &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.$router.params) <span class="comment">// 输出 &#123; id: 2, type: 'test' &#125;</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>需要注意的是：</p><p><code>this.$router.path</code> 所返回的内容H5和小程序存在差异，小程序返回页面路径 <code>/pages/login/index</code>，而H5返回的是 <code>config/index.js</code> 中的 <code>h5.router.customRoutes</code> 配置，也就是浏览器路径 <code>/login</code>(hash、history模式相同)。</p><p>为了保持多终端通用，很显然 wap能用的 <code>hash</code> 就不能使用了。</p><p>在h5中，原生的跳转跟 <code>src/app.js</code> 中配置的路径不一样，例如 <code>&#39;pages/index/index&#39;</code> 在浏览器对应的地址就是 <code>http://localhost:3000/#/pages/index/index</code>， 很显然难以接受，如果需要使用我们习惯的 <code>history</code> 模式，我们需要在配置中( <code>/config/index.js</code> )做如下类似的修改:<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">h5: &#123;</div><div class="line">    publicPath: <span class="string">'/'</span>,</div><div class="line">    ...</div><div class="line">    <span class="comment">// 路由配置</span></div><div class="line">    router: &#123;</div><div class="line">      mode: <span class="string">'browser'</span>,</div><div class="line">      basename: <span class="string">'/'</span>,  <span class="comment">// 基准路径的配置</span></div><div class="line">      customRoutes: &#123;   <span class="comment">// 自定义路由配置</span></div><div class="line">        <span class="string">'/pages/index/index'</span>: <span class="string">'/index'</span>,</div><div class="line">        <span class="string">'/pages/my/index'</span>: <span class="string">'/my'</span>,</div><div class="line">        <span class="string">'/pages/my/info/index'</span>: <span class="string">'/my/info'</span>,</div></pre></td></tr></table></figure><p></p><p>调用 Taro.navigateTo({ url: ‘/pages/index/index’ }) 后，浏览器地址栏将被变为 http:///index。</p><p>跳转 <code>?page=1 or #hash</code> 页面都会刷新，所有生命周期都会重新执行。</p><p><strong><em>注意：Taro.navigateTo 的 url 参数必须 填写 customRoutes 配置中的key，不能 使用 Taro.navigateTo({ url: ‘/my’ })。</em></strong></p><h3 id="路由H5-404处理"><a href="#路由H5-404处理" class="headerlink" title="路由H5 404处理"></a>路由H5 404处理</h3><p>目前没有看到处理方式，包括官方的例子的（h5）404都没有做处理，直接报错白屏。</p><p>目前项目中使用的处理方式比较粗暴：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 自定义H5 404跳转</span></div><div class="line"><span class="keyword">if</span> (isH5) &#123;</div><div class="line">  <span class="built_in">window</span>.onerror = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (e.match(<span class="string">'Can not find proper registered route for'</span>)) &#123;</div><div class="line">      location = <span class="string">'/'</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="样式方面"><a href="#样式方面" class="headerlink" title="样式方面"></a>样式方面</h2><p>无差别，<code>app.js 中 import &#39;global.scss&#39;</code> 为全局通用。组件中 引用 <code>import style from &#39;index.module.scss&#39;</code> 即可。</p><p>样式的写法上，各个终端存在一定的差异。例如 <code>background: #fff url(xxx.png) 30px/100px no-repeat;</code> 简写在RN中不能生效、以及部分属性不支持等。</p><p>推荐使用flex布局，由于RN 只支持flex布局（更重要的是flex布局使用更方便，现在的设备支持情况也良好）。</p><p>详情可参考 <a href="https://taro-docs.jd.com/taro/docs/before-dev-remind.html#%E6%A0%B7%E5%BC%8F%E7%9A%84%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91" target="_blank" rel="external">样式的条件编译</a> | <a href="https://taro-docs.jd.com/taro/docs/specials.html" target="_blank" rel="external">特殊问题的处理</a> | <a href="https://taro-docs.jd.com/taro/docs/component-style.html" target="_blank" rel="external">组件的外部样式和全局样式</a>。</p><h2 id="UI组件差异"><a href="#UI组件差异" class="headerlink" title="UI组件差异"></a>UI组件差异</h2><p>跟小程序类似，只能使用自己的组件 例如 <code>View\Text</code>等，但是在H5中能使用 web自己的组件(div、header、footer等)。如果考虑多终端，那么就不要使用平台自身的东西。</p><p>UI库就没有react那么丰富了，目前只有官方提供的库 <a href="https://taro-ui.aotu.io/" target="_blank" rel="external">TaroUI</a> (目前以后 2271 star)。</p><h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><p>相差无几，多了 <code>componentDidShow</code>，相当于 react 中的 <code>componentWillMount</code> ，小程序中的 <code>onShow</code>。</p><p>另外多了一个 <code>config</code> 配置：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  config = &#123;</div><div class="line">    navigationBarBackgroundColor: <span class="string">'#ffffff'</span>,</div><div class="line">    navigationBarTextStyle: <span class="string">'black'</span>,</div><div class="line">    navigationBarTitleText: <span class="string">'首页'</span>,</div><div class="line">    backgroundColor: <span class="string">'#eeeeee'</span>,</div><div class="line">    backgroundTextStyle: <span class="string">'light'</span></div><div class="line">  &#125;</div><div class="line">  ...</div></pre></td></tr></table></figure><p></p><p>相对的是 小程序的对应的配置。<code>navigationBarTitleText</code> 与 <code>document.title</code> 相等。</p><p>还有小程序专属的函数：<br>下拉刷新事件: <code>onPullDownRefresh()</code> 上拉触底事件: <code>onReachBottom()</code> 滑动页面 <code>onPageScroll()</code> 分享配置<code>onShareAppMessage()</code>等等 <a href="https://taro-docs.jd.com/taro/docs/tutorial.html#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0" target="_blank" rel="external">详细配置</a>。</p><p>还有就是 <code>componentWillMount</code> 表现差异问题，由于小程序里在 <code>onLoad</code> 里才能拿到路由参数信息，而页面 <code>onLoad</code> 前组件已经固定了。因此页面的 <code>componentWillMount</code> 会有和预期表现不一致的问题。<br>处理方法可以用state存起来。</p><p><em>建议放到都放到 <code>DidMount</code> 中执行，因为本身react的 <code>WillMount</code> 是存在重复执行的bug</em></p><p>最后一个taro 提供了一个预加载的钩子 <code>componentWillPreload</code>, 因为在小程序中，从调用 Taro.navigateTo、Taro.redirectTo 或 Taro.switchTab 后，到页面触发 componentWillMount 会有一定延时。因此一些网络请求可以提前到发起跳转前一刻去请求。 而 <code>componentWillPreload</code> 就是为了处理这个问题，它接收页面跳转的参数作为参数。可以把需要预加载的内容通过 return 返回，然后在页面触发 componentWillMount 后即可通过 this.$preloadData 获取到预加载的内容。eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 官方例子</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  componentWillMount () &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'isFetching: '</span>, <span class="keyword">this</span>.isFetching)</div><div class="line">    <span class="keyword">this</span>.$preloadData</div><div class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'res: '</span>, res)</div><div class="line">        <span class="keyword">this</span>.isFetching = <span class="literal">false</span></div><div class="line">      &#125;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillPreload (params) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.fetchData(params.url)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  fetchData () &#123;</div><div class="line">    <span class="keyword">this</span>.isFetching = <span class="literal">true</span></div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="渲染"><a href="#渲染" class="headerlink" title="渲染"></a>渲染</h2><p>组件props的值如果是组件 那么参数名称必须以 rednerXXX开头的驼峰形式。但是 <code>children</code> 可以传任意类型。eg:</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;MyComponent renderHeader=&#123;&lt;View className=&#123;<span class="string">`xxx`</span>&#125;&gt;&lt;/View&gt;&#125; /&gt;  <span class="comment">// correct</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 这样同样会有错误（h5没问题、小程序中存在错误）</span></div><div class="line">render() &#123;</div><div class="line">  <span class="keyword">const</span> renderSuffix = &lt;Text&gt;1&lt;/Text&gt;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &lt;MyComponent renderSuffix=&#123;renderSuffix&#125;&gt;</div><div class="line">&#125;    // error</div><div class="line"></div><div class="line">// 这样则正确</div><div class="line">render() &#123;</div><div class="line"></div><div class="line">  return &lt;MyComponent renderSuffix=&#123;&lt;Text&gt;1&lt;/Text&gt;&#125;&gt;</div><div class="line">&#125;    // correct</div><div class="line"></div><div class="line"></div><div class="line">// renderSuffix 内容只能是 jsx, 不能为其他的（H5中可以是任意类型、但是小程序中必须为jsx）</div></pre></td></tr></table></figure><p>暂不支持在 <code>render()</code> 之外的方法定义 JSX (v1.3.0-beta.0 起支持)</p><p>不能在 JSX 参数中使用对象展开符 (v1.3.0-beta.0 起，自定义组件可以使用对象展开符，内置组件仍然需要分别单独传入参数) eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> params = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;</div><div class="line"></div><div class="line">&lt;MyComponent ...params /&gt;  <span class="comment">// error</span></div><div class="line"></div><div class="line">&lt;MyComponent a=&#123;params.a&#125; ... /&gt;</div></pre></td></tr></table></figure><p>在 Taro 中，父组件要往子组件传递函数，属性名必须以 on 开头，这是因为微信小程序端组件化是不能直接传递函数类型给子组件的，在 Taro 中是借助组件的事件机制来实现这一特性，而小程序中传入事件的时候属性名写法为 <code>bindmyevent</code> 或者 <code>bind:myevent</code>。</p><p>给组件设置 defaultProps：</p><p>我们知道在小程序中组件属性只有定义在 <code>properties</code> 中，才能被识别，eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Component(&#123;</div><div class="line">  properties: &#123;</div><div class="line">    props1: &#123; <span class="comment">// 属性名</span></div><div class="line">      type: <span class="built_in">String</span>, <span class="comment">// 类型（必填），目前接受的类型包括：String, Number, Boolean, Object, Array, null（表示任意类型）</span></div><div class="line">      value: <span class="string">''</span>, <span class="comment">// 属性初始值（可选），如果未指定则会根据类型选择一个</span></div><div class="line">      observer:  <span class="function">(<span class="params">newVal, oldVal, changedPath</span>) =&gt;</span> &#123;</div><div class="line">         <span class="comment">// 属性被改变时执行的函数（可选），也可以写成在 methods 段中定义的方法名字符串, 如：'_propertyChange'</span></div><div class="line">         <span class="comment">// 通常 newVal 就是新设置的数据， oldVal 是旧数据</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    props2: <span class="built_in">String</span>, <span class="comment">// 简化的定义方式</span></div><div class="line">  &#125;</div><div class="line">  ...</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>而在taro中规定则是每个组件属性必须定义在 <code>defaultProps</code> 中，eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Component</span> <span class="keyword">extends</span> <span class="title">Taro</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> defaultProps = &#123;</div><div class="line">    props1: <span class="string">''</span>,</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>通过设置 <code>defaultProps</code> 在运行时用来处理编译时处理不到的异常情况，而所有的属性都会被追加到 <code>properties</code> 中初始化组件，设置正确的 <code>defaultProps</code> 能够避免一些异常的情况的出现。</p><p>不要用 <code>id、class、style</code> 作为自定义组件的 <code>props</code> 与内部 <code>state</code> 的名称，因为这些属性名在微信小程序中会丢失。</p><p>不要在 <code>state</code> 与 <code>props</code> 中用相同名称的字段，原因是这些被字段在转成小程序后都会放到 <code>this.data</code> 上（eg：会触发错误 <code>ESLint(taro/duplicate-name-of-state-and-props) 错误：this.state.value 与 this.props.value 重复可能会导致渲染结不如意料之中的结果</code>）。</p><p>Taro 里尽量使用单引号，尤其是 JSX，使用双引号 可能会导致编译错误。</p><p>在JSX中，不支持柯里化（自 v1.3.0-beta.1 开始支持）。</p><p><code>export { default as iconEye } from &#39;./eye.png&#39;</code> 暂时不支持这样统一暴露。<em>小程序</em></p><p>jsx中不要写匿名函数，会遇到的情况就是H5解析没问题，但是在小程序解析时会报错。<em>小程序</em></p><p>高阶组件中的 <code>super.render()</code> 在小程序中无法使用，因为小程序编译后是没有render的，<code>jsx</code> 部分会被编译成 <code>wxml</code>，<code>return</code> 之前的数据处理会被编译到 _createData() 方法里。<em>小程序</em></p><p>自定义组件不能和 内置组件名称相同 （Button Input 等），会触发 <code>Error: 内置组件名: &#39;Input&#39; 只能从 @tarojs/components 引入。</code> 错误提示。<em>小程序</em></p><p>循环中的 ref 只能使用函数。(ref 仅支持传入字符串、匿名箭头函数和 class 中已声明的函数) <em>小程序</em></p><p>组件事件传参只能在使用匿名箭头函数，或使用类作用域下的确切引用(this.handleXX || this.props.handleXX)，或使用 bind。<em>小程序</em></p><p>render 函数定义一个不从 this.state 解构或赋值而来的变量，此变量又与 this.state 下的变量重名可能会导致无法渲染。<em>小程序</em> eg:</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">render() &#123;</div><div class="line">  <span class="keyword">const</span> &#123; len, error, focus, complite, &#125; = <span class="keyword">this</span>.props</div><div class="line">  <span class="keyword">const</span> &#123; value &#125; = <span class="keyword">this</span>.state</div><div class="line">  <span class="keyword">const</span> gridStyle = <span class="string">`<span class="subst">$&#123;styles.grid&#125;</span> <span class="subst">$&#123;error ? (value.length === len &amp;&amp; styles.err) : <span class="string">''</span>&#125;</span>`</span></div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;View className=&#123;styles.box&#125;&gt;</div><div class="line">      &lt;MYInput</div><div class="line">        focus=&#123;value.length === len ? <span class="literal">false</span> : focus&#125;   <span class="comment">// 长度达到6位自动隐藏键盘</span></div><div class="line">        className=&#123;styles.ipt&#125;</div><div class="line">        type=<span class="string">'number'</span></div><div class="line">        onInput=&#123;e =&gt; &#123;</div><div class="line">          <span class="keyword">const</span> value = e.detail.value     <span class="comment">// 这里定义的value会触发此错误，解决方案此处的value更换为不予state.value字段重复即可</span></div><div class="line">          <span class="keyword">this</span>.setState(&#123; value &#125;, e =&gt; &#123;</div><div class="line">            <span class="keyword">if</span> (value.length === len) &#123;</div><div class="line">              <span class="keyword">try</span> &#123;</div><div class="line">                <span class="keyword">this</span>.inputRef.inputRef.blur()</div><div class="line">                complite(<span class="keyword">this</span>)</div><div class="line">              &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">                Toast(&#123; <span class="attr">title</span>: e.message, <span class="attr">icon</span>: <span class="string">'error'</span> &#125;)</div><div class="line">              &#125;</div><div class="line">            &#125;</div><div class="line">          &#125;)</div><div class="line">        &#125;&#125;</div><div class="line">...</div></pre></td></tr></table></figure><p>在 <code>scss</code> 中第一样和最后一行 注释 不能使用 <code>// 注释内容</code>, 解决方案 要么使用 <code>/* 注释内容 */</code> 或者 删掉注释。<em>小程序</em></p><p><code>this.props.children</code> 为只读, 如需在自定义方法中调用 需要用到ES6对象解析 <code>const {children} = this.props</code>，否则会触发 <code>(taro/render-props) 错误：无法操作 this.props.children</code> 错误。<em>小程序</em></p><p>自定义组件 <code>render</code> 不能返回 <code>null</code>,会触发错误 <code>组件Marker路径错误，请检查！（可能原因是导出的组件名不正确）</code>。<em>小程序</em></p><p>在样式文件里不能使用本地图作为背景图片，即 <code>background: url(../assets....)</code>。需要使用网络图片或者使用 <code>&lt;Image /&gt;</code> 标签。 <em>小程序</em></p><h2 id="资源引入"><a href="#资源引入" class="headerlink" title="资源引入"></a>资源引入</h2><p>在react 中我们能 在jsx中动态引入图片,eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">render() &#123;</div><div class="line">  <span class="keyword">return</span> &lt;Image src=&#123;require(`@/assets/images/$&#123;this.state.index&#125;.png`)&#125; /&gt;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>但是在taro中，目前不支持，但是他提供了一个需要手动配置的配置项 <a href="https://nervjs.github.io/taro/docs/config-detail.html#copy" target="_blank" rel="external">copy</a> 来达到此目的。<br>手动指定需要copy的目录，就ok了， eg：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">copy: &#123;</div><div class="line">  patterns: [</div><div class="line">    &#123; <span class="attr">from</span>: <span class="string">'src/asset/tt/'</span>, <span class="attr">to</span>: <span class="string">'dist/asset/tt/'</span>, <span class="attr">ignore</span>: <span class="string">'*.js'</span> &#125;, <span class="comment">// 指定需要 copy 的目录</span></div><div class="line">    &#123; <span class="attr">from</span>: <span class="string">'src/asset/tt/sd.jpg'</span>, <span class="attr">to</span>: <span class="string">'dist/asset/tt/sd.jpg'</span> &#125; <span class="comment">// 指定需要 copy 的文件</span></div><div class="line">  ]</div><div class="line">&#125;,</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// used</span></div><div class="line">&lt;Image src=&#123;<span class="string">`/assets/images/<span class="subst">$&#123;<span class="keyword">this</span>.state.index&#125;</span>.png`</span>&#125; /&gt;</div></pre></td></tr></table></figure><p><em>原因是 地址替换这一步是放到编译时做的，需在编译时找到引入的图片然后 copy 到 dist 目录。</em></p><h2 id="跨平台开发"><a href="#跨平台开发" class="headerlink" title="跨平台开发"></a>跨平台开发</h2><p>如上简介所说：</p><p>官方也提供兼容处理形式：以文件后缀来区分针对不同的端打包运行 eg: <code>vehicle.h5.js</code> 只会针对h5运行…，以及环境变量的提供 <code>process.env.TARO_ENV = weapp / swan / alipay / h5 / rn / tt</code></p><h2 id="数据管理"><a href="#数据管理" class="headerlink" title="数据管理"></a>数据管理</h2><p>taro推荐使用redux来管理数据，刚好和我们相同。但是如果小项目小功能的程序那么久不适合用数据管理了(太重)。自己维护一个global.js就可以，eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> globalData = &#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">set</span> (<span class="params">key, val</span>) </span>&#123;</div><div class="line">  globalData[key] = val</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span> (<span class="params">key</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> globalData[key]</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// use</span></div><div class="line"><span class="keyword">import</span> &#123; set <span class="keyword">as</span> setGlobalData, get <span class="keyword">as</span> getGlobalData &#125; <span class="keyword">from</span> <span class="string">'./path/name/global_data'</span></div><div class="line"></div><div class="line">setGlobalData(<span class="string">'test'</span>, <span class="number">1</span>)</div><div class="line"></div><div class="line">getGlobalData(<span class="string">'test'</span>)</div></pre></td></tr></table></figure><h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>性能方面可优化的其实跟react相差无几:</p><p>可以通过 <code>shouldComponentUpdate</code> 来避免重复渲染</p><p>以及 <code>React.PureComponent</code> 在taro中同样有 <code>Taro.PureComponent</code>，</p><p>在react中新增的useMemo，taro中同样有 <code>Taro.memo</code>。</p><p>…</p><h2 id="支付宝、微信、字节跳动小程序差异。"><a href="#支付宝、微信、字节跳动小程序差异。" class="headerlink" title="支付宝、微信、字节跳动小程序差异。"></a>支付宝、微信、字节跳动小程序差异。</h2><p>其他注意事项已经在官网有详细的说明,<a href="https://taro-docs.jd.com/taro/docs/before-dev-remind.html" target="_blank" rel="external">开发前注意 </a>| <a href="https://taro-docs.jd.com/taro/docs/specials.html" target="_blank" rel="external">特殊问题的处理</a> 。</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Taro/" rel="tag"># Taro</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/09/13/weex采坑记录/" rel="next" title="weex采坑记录"><i class="fa fa-chevron-left"></i> weex采坑记录</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/raul.jpg" alt="jiangwanwei"><p class="site-author-name" itemprop="name">jiangwanwei</p><p class="site-description motion-element" itemprop="description">A little ...</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">21</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">17</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#框架简介"><span class="nav-number">1.</span> <span class="nav-text">框架简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法风格"><span class="nav-number">2.</span> <span class="nav-text">语法风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不足"><span class="nav-number">3.</span> <span class="nav-text">不足</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装"><span class="nav-number">4.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置"><span class="nav-number">5.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#路由"><span class="nav-number">6.</span> <span class="nav-text">路由</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#路由H5-404处理"><span class="nav-number">6.1.</span> <span class="nav-text">路由H5 404处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#样式方面"><span class="nav-number">7.</span> <span class="nav-text">样式方面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UI组件差异"><span class="nav-number">8.</span> <span class="nav-text">UI组件差异</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生命周期"><span class="nav-number">9.</span> <span class="nav-text">生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#渲染"><span class="nav-number">10.</span> <span class="nav-text">渲染</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#资源引入"><span class="nav-number">11.</span> <span class="nav-text">资源引入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#跨平台开发"><span class="nav-number">12.</span> <span class="nav-text">跨平台开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据管理"><span class="nav-number">13.</span> <span class="nav-text">数据管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#性能"><span class="nav-number">14.</span> <span class="nav-text">性能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#支付宝、微信、字节跳动小程序差异。"><span class="nav-number">15.</span> <span class="nav-text">支付宝、微信、字节跳动小程序差异。</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">jiangwanwei</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/three/three.min.js"></script><script type="text/javascript" src="/lib/three/canvas_sphere.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;w<0&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script></body></html><!-- rebuild by neat -->